<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Repartidor - El Buen Gusto</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-brown': 'rgb(80, 50, 20)',
                        'primary-cream': 'rgb(245, 235, 210)',
                        'primary-red': 'rgb(200, 30, 45)'
                    },
                    fontFamily: {
                        'averia': ['"Averia Serif Libre"', 'serif']
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Averia+Serif+Libre:wght@400;700&display=swap" rel="stylesheet">
    <style>
        .status-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .notification-slide {
            animation: slideDown 0.3s ease-out;
        }
        
        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="font-averia bg-primary-cream min-h-screen">
    
    <!-- Header -->
    <header class="bg-primary-red shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-4">
                    <div class="text-3xl">üçó</div>
                    <div>
                        <h1 class="text-white text-2xl font-bold">El Buen Gusto</h1>
                        <p class="text-primary-cream text-sm">Panel Repartidor</p>
                    </div>
                </div>
                
                <div class="flex items-center gap-4">
                    <!-- Estado del Repartidor -->
                    <div class="flex items-center gap-2">
                        <span class="text-white">Estado:</span>
                        <button id="statusToggle" onclick="toggleStatus()" 
                                class="px-4 py-2 rounded-full text-sm font-bold transition-all duration-300 status-animation">
                            <span id="statusText">Disponible</span>
                        </button>
                    </div>
                    
                    <!-- Perfil -->
                    <div class="flex items-center gap-3 text-white">
                        <div class="w-10 h-10 bg-primary-cream rounded-full flex items-center justify-center text-primary-brown font-bold">
                            JD
                        </div>
                        <div>
                            <p class="text-sm font-bold">Juan Delivery</p>
                            <p class="text-xs text-primary-cream">Repartidor</p>
                        </div>
                    </div>
                    
                    <!-- Cerrar sesi√≥n -->
                    <button class="bg-primary-brown hover:bg-opacity-80 text-white px-4 py-2 rounded-lg transition-colors duration-300">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Notificaciones -->
    <div id="notifications" class="fixed top-20 right-4 z-40 space-y-2"></div>

    <!-- Contenido Principal -->
    <main class="max-w-7xl mx-auto px-4 py-6">
        
        <!-- Estad√≠sticas R√°pidas -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white rounded-xl shadow-md p-6 border-l-4 border-primary-red">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-primary-brown text-sm font-medium">Entregas Hoy</p>
                        <p class="text-3xl font-bold text-primary-red" id="entregasHoy">12</p>
                    </div>
                    <div class="text-4xl">üì¶</div>
                </div>
            </div>
            
            <div class="bg-white rounded-xl shadow-md p-6 border-l-4 border-green-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-primary-brown text-sm font-medium">Ganancia Hoy</p>
                        <p class="text-3xl font-bold text-green-600" id="gananciaHoy">$4,800</p>
                    </div>
                    <div class="text-4xl">üí∞</div>
                </div>
            </div>
            
            <div class="bg-white rounded-xl shadow-md p-6 border-l-4 border-blue-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-primary-brown text-sm font-medium">Promedio Rese√±as</p>
                        <p class="text-3xl font-bold text-blue-600" id="promedioRese√±as">4.8</p>
                    </div>
                    <div class="text-4xl">‚≠ê</div>
                </div>
            </div>
            
            <div class="bg-white rounded-xl shadow-md p-6 border-l-4 border-orange-500">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-primary-brown text-sm font-medium">Pendientes</p>
                        <p class="text-3xl font-bold text-orange-600" id="pedidosPendientes">3</p>
                    </div>
                    <div class="text-4xl">üöö</div>
                </div>
            </div>
        </div>

        <!-- Pedidos Asignados -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <!-- Entregas Pendientes -->
            <div class="bg-white rounded-xl shadow-lg">
                <div class="bg-primary-red text-white p-6 rounded-t-xl">
                    <h2 class="text-xl font-bold flex items-center gap-3">
                        üöö Entregas Pendientes
                        <span id="pendingCount" class="bg-white text-primary-red px-3 py-1 rounded-full text-sm">3</span>
                    </h2>
                </div>
                
                <div id="pedidosPendientesContainer" class="p-6 space-y-4 max-h-96 overflow-y-auto">
                    <!-- Los pedidos se cargar√°n aqu√≠ din√°micamente -->
                </div>
            </div>

            <!-- Entregas en Camino -->
            <div class="bg-white rounded-xl shadow-lg">
                <div class="bg-blue-600 text-white p-6 rounded-t-xl">
                    <h2 class="text-xl font-bold flex items-center gap-3">
                        üõ£Ô∏è En Camino
                        <span id="enCaminoCount" class="bg-white text-blue-600 px-3 py-1 rounded-full text-sm">1</span>
                    </h2>
                </div>
                
                <div id="pedidosEnCaminoContainer" class="p-6 space-y-4 max-h-96 overflow-y-auto">
                    <!-- Los pedidos en camino se cargar√°n aqu√≠ -->
                </div>
            </div>
        </div>

        <!-- Historial de Entregas -->
        <div class="mt-8 bg-white rounded-xl shadow-lg">
            <div class="bg-green-600 text-white p-6 rounded-t-xl">
                <h2 class="text-xl font-bold flex items-center gap-3">
                    ‚úÖ Entregas Completadas Hoy
                </h2>
            </div>
            
            <div class="p-6">
                <div id="historialContainer" class="space-y-3 max-h-64 overflow-y-auto">
                    <!-- Historial se cargar√° aqu√≠ -->
                </div>
            </div>
        </div>

        <!-- Modal de Rese√±as -->
        <div id="reviewModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
            <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 max-h-96 overflow-y-auto">
                <div class="bg-primary-red text-white p-6 rounded-t-2xl">
                    <div class="flex justify-between items-center">
                        <h3 class="text-xl font-bold">üìù Rese√±as del Pedido</h3>
                        <button onclick="closeReviewModal()" class="text-white hover:bg-red-600 p-2 rounded-full">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <div id="reviewContent" class="p-6">
                    <!-- Contenido de rese√±as se cargar√° aqu√≠ -->
                </div>
            </div>
        </div>

    </main>

    <script>
        // Estado del repartidor
        let isAvailable = true;
        let pedidos = [
            {
                id: 1,
                cliente: "Mar√≠a Gonz√°lez",
                direccion: "Av. Libertador 1234, San Isidro",
                telefono: "11-1234-5678",
                total: 12500,
                items: ["2x Pollo Entero", "1x Pizza Muzzarella", "2x Coca Cola"],
                estado: "listo",
                tiempoEstimado: "15 min",
                distancia: "2.3 km",
                rese√±as: {
                    entrega: { puntuacion: 5, comentario: "Lleg√≥ s√∫per r√°pido y caliente!" }
                }
            },
            {
                id: 2,
                cliente: "Carlos Ruiz",
                direccion: "Mitre 567, Vicente L√≥pez",
                telefono: "11-8765-4321",
                total: 8700,
                items: ["1x Empanadas x12", "1x Flan Casero"],
                estado: "listo",
                tiempoEstimado: "20 min",
                distancia: "1.8 km"
            },
            {
                id: 3,
                cliente: "Ana Torres",
                direccion: "Belgrano 890, Villa Adelina",
                telefono: "11-5555-1234",
                total: 15300,
                items: ["4x Milanesas", "1x Tarta J&Q", "3x Agua"],
                estado: "enCamino",
                tiempoEstimado: "10 min",
                distancia: "0.9 km"
            }
        ];

        let historial = [
            {
                id: 10,
                cliente: "Luis P√©rez",
                direccion: "San Mart√≠n 123",
                total: 9500,
                horaEntrega: "14:30",
                rese√±as: {
                    entrega: { puntuacion: 4, comentario: "Muy buen servicio" }
                }
            },
            {
                id: 11,
                cliente: "Sofia Mendez",
                direccion: "Rivadavia 456",
                total: 7200,
                horaEntrega: "13:15",
                rese√±as: {
                    entrega: { puntuacion: 5, comentario: "Excelente atenci√≥n!" }
                }
            }
        ];

        // Funci√≥n para alternar estado
        function toggleStatus() {
            isAvailable = !isAvailable;
            const statusButton = document.getElementById('statusToggle');
            const statusText = document.getElementById('statusText');
            
            if (isAvailable) {
                statusButton.className = 'px-4 py-2 rounded-full text-sm font-bold bg-green-500 text-white status-animation';
                statusText.textContent = 'Disponible';
            } else {
                statusButton.className = 'px-4 py-2 rounded-full text-sm font-bold bg-gray-500 text-white';
                statusText.textContent = 'No Disponible';
            }
            
            showNotification(isAvailable ? 'Estado cambiado a Disponible' : 'Estado cambiado a No Disponible');
        }

        // Funci√≥n para mostrar notificaciones
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500'
            };
            
            notification.className = `${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg notification-slide`;
            notification.innerHTML = `
                <div class="flex items-center gap-3">
                    <span>${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="text-white hover:bg-black hover:bg-opacity-20 p-1 rounded">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            document.getElementById('notifications').appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        // Funci√≥n para marcar pedido como en camino
        function marcarEnCamino(pedidoId) {
            const pedido = pedidos.find(p => p.id === pedidoId);
            if (pedido) {
                pedido.estado = 'enCamino';
                renderPedidos();
                showNotification(`Pedido #${pedidoId} marcado como "En Camino"`, 'success');
            }
        }

        // Funci√≥n para marcar pedido como entregado
        function marcarEntregado(pedidoId) {
            const pedido = pedidos.find(p => p.id === pedidoId);
            if (pedido) {
                pedido.estado = 'entregado';
                pedido.horaEntrega = new Date().toLocaleTimeString('es-AR', {hour: '2-digit', minute:'2-digit'});
                
                // Mover al historial
                historial.unshift(pedido);
                pedidos = pedidos.filter(p => p.id !== pedidoId);
                
                // Actualizar estad√≠sticas
                updateStats();
                renderPedidos();
                renderHistorial();
                
                showNotification(`Pedido #${pedidoId} entregado correctamente`, 'success');
            }
        }

        // Funci√≥n para ver rese√±as
        function verRese√±as(pedidoId) {
            const pedido = [...pedidos, ...historial].find(p => p.id === pedidoId);
            if (pedido && pedido.rese√±as) {
                const modal = document.getElementById('reviewModal');
                const content = document.getElementById('reviewContent');
                
                content.innerHTML = `
                    <div class="space-y-4">
                        <div class="text-center">
                            <h4 class="text-lg font-bold text-primary-brown">Pedido #${pedido.id}</h4>
                            <p class="text-gray-600">${pedido.cliente}</p>
                        </div>
                        
                        ${pedido.rese√±as.entrega ? `
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h5 class="font-bold text-blue-800 mb-2">Rese√±a del Servicio de Entrega</h5>
                            <div class="flex items-center gap-2 mb-2">
                                <span class="text-yellow-500">${'‚≠ê'.repeat(pedido.rese√±as.entrega.puntuacion)}</span>
                                <span class="text-gray-600">(${pedido.rese√±as.entrega.puntuacion}/5)</span>
                            </div>
                            <p class="text-gray-700">"${pedido.rese√±as.entrega.comentario}"</p>
                        </div>
                        ` : '<p class="text-gray-500 text-center">A√∫n no hay rese√±as para este pedido</p>'}
                    </div>
                `;
                
                modal.classList.remove('hidden');
            }
        }

        // Funci√≥n para cerrar modal de rese√±as
        function closeReviewModal() {
            document.getElementById('reviewModal').classList.add('hidden');
        }

        // Funci√≥n para renderizar pedidos
        function renderPedidos() {
            const pendientes = pedidos.filter(p => p.estado === 'listo');
            const enCamino = pedidos.filter(p => p.estado === 'enCamino');
            
            // Actualizar contadores
            document.getElementById('pendingCount').textContent = pendientes.length;
            document.getElementById('enCaminoCount').textContent = enCamino.length;
            document.getElementById('pedidosPendientes').textContent = pendientes.length;
            
            // Renderizar pendientes
            const pendientesContainer = document.getElementById('pedidosPendientesContainer');
            pendientesContainer.innerHTML = pendientes.length > 0 ? pendientes.map(pedido => `
                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow duration-300 fade-in">
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h4 class="font-bold text-primary-brown">Pedido #${pedido.id}</h4>
                            <p class="text-gray-600">${pedido.cliente}</p>
                        </div>
                        <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-medium">
                            Listo
                        </span>
                    </div>
                    
                    <div class="space-y-2 text-sm text-gray-700 mb-4">
                        <p><strong>üìç Direcci√≥n:</strong> ${pedido.direccion}</p>
                        <p><strong>üìû Tel√©fono:</strong> ${pedido.telefono}</p>
                        <p><strong>üïí Tiempo est.:</strong> ${pedido.tiempoEstimado}</p>
                        <p><strong>üìè Distancia:</strong> ${pedido.distancia}</p>
                        <p><strong>üí∞ Total:</strong> $${pedido.total.toLocaleString()}</p>
                    </div>
                    
                    <div class="mb-4">
                        <p class="font-medium text-primary-brown mb-2">Items del pedido:</p>
                        <ul class="text-sm text-gray-600">
                            ${pedido.items.map(item => `<li>‚Ä¢ ${item}</li>`).join('')}
                        </ul>
                    </div>
                    
                    <div class="flex gap-2">
                        <button onclick="marcarEnCamino(${pedido.id})" 
                                class="flex-1 bg-primary-red hover:bg-red-600 text-white py-2 px-4 rounded-lg transition-colors duration-300">
                            üöö Salir a Entregar
                        </button>
                        ${pedido.rese√±as ? `
                        <button onclick="verRese√±as(${pedido.id})" 
                                class="bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 px-4 rounded-lg transition-colors duration-300">
                            üìù
                        </button>
                        ` : ''}
                    </div>
                </div>
            `).join('') : '<p class="text-gray-500 text-center py-8">No hay entregas pendientes</p>';
            
            // Renderizar en camino
            const enCaminoContainer = document.getElementById('pedidosEnCaminoContainer');
            enCaminoContainer.innerHTML = enCamino.length > 0 ? enCamino.map(pedido => `
                <div class="border border-blue-200 rounded-lg p-4 bg-blue-50 fade-in">
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h4 class="font-bold text-primary-brown">Pedido #${pedido.id}</h4>
                            <p class="text-gray-600">${pedido.cliente}</p>
                        </div>
                        <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">
                            En Camino
                        </span>
                    </div>
                    
                    <div class="space-y-2 text-sm text-gray-700 mb-4">
                        <p><strong>üìç Direcci√≥n:</strong> ${pedido.direccion}</p>
                        <p><strong>üìû Tel√©fono:</strong> ${pedido.telefono}</p>
                        <p><strong>üí∞ Total:</strong> $${pedido.total.toLocaleString()}</p>
                    </div>
                    
                    <button onclick="marcarEntregado(${pedido.id})" 
                            class="w-full bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded-lg transition-colors duration-300">
                        ‚úÖ Marcar como Entregado
                    </button>
                </div>
            `).join('') : '<p class="text-gray-500 text-center py-8">No hay entregas en camino</p>';
        }

        // Funci√≥n para renderizar historial
        function renderHistorial() {
            const historialContainer = document.getElementById('historialContainer');
            historialContainer.innerHTML = historial.length > 0 ? historial.map(pedido => `
                <div class="flex justify-between items-center p-3 bg-green-50 rounded-lg">
                    <div>
                        <p class="font-medium text-gray-800">Pedido #${pedido.id} - ${pedido.cliente}</p>
                        <p class="text-sm text-gray-600">${pedido.direccion}</p>
                        <p class="text-sm text-green-600">Entregado a las ${pedido.horaEntrega}</p>
                    </div>
                    <div class="text-right">
                        <p class="font-bold text-green-600">$${pedido.total.toLocaleString()}</p>
                        ${pedido.rese√±as ? `
                        <button onclick="verRese√±as(${pedido.id})" 
                                class="text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1 rounded-full mt-1">
                            Ver Rese√±a
                        </button>
                        ` : ''}
                    </div>
                </div>
            `).join('') : '<p class="text-gray-500 text-center py-4">No hay entregas completadas hoy</p>';
        }

        // Funci√≥n para actualizar estad√≠sticas
        function updateStats() {
            const entregasHoy = historial.length;
            const gananciaHoy = historial.reduce((total, pedido) => total + (pedido.total * 0.1), 0); // 10% por entrega
            const promedioRese√±as = historial
                .filter(p => p.rese√±as && p.rese√±as.entrega)
                .reduce((avg, p, _, arr) => avg + p.rese√±as.entrega.puntuacion / arr.length, 0);
            
            document.getElementById('entregasHoy').textContent = entregasHoy;
            document.getElementById('gananciaHoy').textContent = `$${gananciaHoy.toLocaleString()}`;
            document.getElementById('promedioRese√±as').textContent = promedioRese√±as.toFixed(1);
        }

        // Inicializar la aplicaci√≥n
        function init() {
            renderPedidos();
            renderHistorial();
            updateStats();
            
            // Simular nuevos pedidos cada 30 segundos (para demostraci√≥n)
            setInterval(() => {
                if (Math.random() > 0.7) { // 30% de probabilidad
                    const nuevoId = Math.max(...pedidos.map(p => p.id)) + 1;
                    pedidos.push({
                        id: nuevoId,
                        cliente: "Cliente Nuevo",
                        direccion: "Direcci√≥n Nueva 123",
                        telefono: "11-0000-0000",
                        total: Math.floor(Math.random() * 15000) + 5000,
                        items: ["Producto Nuevo"],
                        estado: "listo",
                        tiempoEstimado: "20 min",
                        distancia: "1.5 km"
                    });
                    renderPedidos();
                    showNotification('¬°Nuevo pedido asignado!', 'success');
                }
            }, 30000);
        }

        // Inicializar cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', init);
    </script>

</body>
</html>